{"ast":null,"code":"import { ConsoleLogger } from '../../Logger/ConsoleLogger.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst logger = new ConsoleLogger('Auth');\nclass AuthClass {\n  /**\n   * Configure Auth category\n   *\n   * @internal\n   *\n   * @param authResourcesConfig - Resources configurations required by Auth providers.\n   * @param authOptions - Client options used by library\n   *\n   * @returns void\n   */\n  configure(authResourcesConfig, authOptions) {\n    this.authConfig = authResourcesConfig;\n    this.authOptions = authOptions;\n    if (authResourcesConfig && authResourcesConfig.Cognito?.userPoolEndpoint) {\n      logger.warn(getCustomEndpointWarningMessage('Amazon Cognito User Pool'));\n    }\n    if (authResourcesConfig && authResourcesConfig.Cognito?.identityPoolEndpoint) {\n      logger.warn(getCustomEndpointWarningMessage('Amazon Cognito Identity Pool'));\n    }\n  }\n  /**\n   * Fetch the auth tokens, and the temporary AWS credentials and identity if they are configured. By default it\n   * does not refresh the auth tokens or credentials if they are loaded in storage already. You can force a refresh\n   * with `{ forceRefresh: true }` input.\n   *\n   * @param options - Options configuring the fetch behavior.\n   *\n   * @returns Promise of current auth session {@link AuthSession}.\n   */\n  async fetchAuthSession(options = {}) {\n    let credentialsAndIdentityId;\n    let userSub;\n    // Get tokens will throw if session cannot be refreshed (network or service error) or return null if not available\n    const tokens = await this.getTokens(options);\n    if (tokens) {\n      userSub = tokens.accessToken?.payload?.sub;\n      // getCredentialsAndIdentityId will throw if cannot get credentials (network or service error)\n      credentialsAndIdentityId = await this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({\n        authConfig: this.authConfig,\n        tokens,\n        authenticated: true,\n        forceRefresh: options.forceRefresh\n      });\n    } else {\n      // getCredentialsAndIdentityId will throw if cannot get credentials (network or service error)\n      credentialsAndIdentityId = await this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({\n        authConfig: this.authConfig,\n        authenticated: false,\n        forceRefresh: options.forceRefresh\n      });\n    }\n    return {\n      tokens,\n      credentials: credentialsAndIdentityId?.credentials,\n      identityId: credentialsAndIdentityId?.identityId,\n      userSub\n    };\n  }\n  async clearCredentials() {\n    await this.authOptions?.credentialsProvider?.clearCredentialsAndIdentityId();\n  }\n  async getTokens(options) {\n    return (await this.authOptions?.tokenProvider?.getTokens(options)) ?? undefined;\n  }\n}\nconst getCustomEndpointWarningMessage = target => `You are using a custom Amazon ${target} endpoint, ensure the endpoint is correct.`;\nexport { AuthClass };\n//# sourceMappingURL=index.mjs.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}