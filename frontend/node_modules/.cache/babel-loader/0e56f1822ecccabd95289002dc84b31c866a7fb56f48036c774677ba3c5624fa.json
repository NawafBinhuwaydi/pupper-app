{"ast":null,"code":"import _objectSpread from\"/home/nawaf/aws-project/pupper-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useLocation,useNavigate}from'react-router-dom';import SearchAndFilter from'../components/SearchAndFilter';import SearchResults from'../components/SearchResults';import Pagination from'../components/Pagination';import{useDogs}from'../hooks/useDogs';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SearchPage=()=>{var _data$data,_data$data2,_data$data3,_data$data4;const location=useLocation();const navigate=useNavigate();// Parse URL parameters\nconst urlParams=new URLSearchParams(location.search);const initialFilters=Object.fromEntries(urlParams.entries());const[currentPage,setCurrentPage]=useState(parseInt(initialFilters.page)||1);const[itemsPerPage,setItemsPerPage]=useState(parseInt(initialFilters.limit)||20);const[filters,setFilters]=useState(initialFilters);// Fetch dogs with current filters\nconst{data,isLoading,error,refetch}=useDogs(_objectSpread(_objectSpread({},filters),{},{page:currentPage,limit:itemsPerPage}));// Update URL when filters change\nuseEffect(()=>{const params=new URLSearchParams();Object.entries(filters).forEach(_ref=>{let[key,value]=_ref;if(value&&value!==''){params.set(key,value);}});if(currentPage>1){params.set('page',currentPage.toString());}if(itemsPerPage!==20){params.set('limit',itemsPerPage.toString());}const newSearch=params.toString();const newUrl=newSearch?\"\".concat(location.pathname,\"?\").concat(newSearch):location.pathname;if(newUrl!==\"\".concat(location.pathname).concat(location.search)){navigate(newUrl,{replace:true});}},[filters,currentPage,itemsPerPage,location.pathname,location.search,navigate]);const handleFiltersChange=newFilters=>{setFilters(newFilters);setCurrentPage(1);// Reset to first page when filters change\n};const handlePageChange=page=>{setCurrentPage(page);// Scroll to top when page changes\nwindow.scrollTo({top:0,behavior:'smooth'});};const handleItemsPerPageChange=newLimit=>{setItemsPerPage(newLimit);setCurrentPage(1);// Reset to first page when limit changes\n};const dogs=(data===null||data===void 0?void 0:(_data$data=data.data)===null||_data$data===void 0?void 0:_data$data.dogs)||[];const pagination=(data===null||data===void 0?void 0:(_data$data2=data.data)===null||_data$data2===void 0?void 0:_data$data2.pagination)||{};const appliedFilters=(data===null||data===void 0?void 0:(_data$data3=data.data)===null||_data$data3===void 0?void 0:_data$data3.filters_applied)||{};const sortInfo=(data===null||data===void 0?void 0:(_data$data4=data.data)===null||_data$data4===void 0?void 0:_data$data4.sort)||{};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-2\",children:\"Find Your Perfect Companion\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Search and filter through our available dogs to find your new best friend.\"})]}),/*#__PURE__*/_jsx(SearchAndFilter,{onFiltersChange:handleFiltersChange,initialFilters:filters,isLoading:isLoading}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\",children:[/*#__PURE__*/_jsx(SearchResults,{dogs:dogs,isLoading:isLoading,error:error,totalResults:pagination.total_items||0,appliedFilters:appliedFilters,searchQuery:filters.search||'',onRetry:refetch}),pagination.total_pages>1&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-8\",children:/*#__PURE__*/_jsx(Pagination,{currentPage:pagination.current_page||1,totalPages:pagination.total_pages||1,totalItems:pagination.total_items||0,itemsPerPage:pagination.per_page||itemsPerPage,onPageChange:handlePageChange,onItemsPerPageChange:handleItemsPerPageChange,isLoading:isLoading})})]}),!isLoading&&dogs.length===0&&!error&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-blue-900 mb-3\",children:\"Search Tips\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-blue-800 space-y-2 text-sm\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Use keywords like dog names, breeds, colors, or shelter names\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Try broader search terms if you're not finding results\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Use the advanced filters to narrow down by specific criteria\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Check different status options (available, adopted, pending)\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Adjust age and weight ranges to see more options\"})]})]}),process.env.NODE_ENV==='development'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 bg-gray-100 border border-gray-300 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 mb-2\",children:\"Debug Info\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Current Page: \",currentPage]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Items Per Page: \",itemsPerPage]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Total Results: \",pagination.total_items||0]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Total Pages: \",pagination.total_pages||0]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Applied Filters: \",JSON.stringify(appliedFilters,null,2)]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Sort: \",JSON.stringify(sortInfo,null,2)]})]})]})]})});};export default SearchPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}