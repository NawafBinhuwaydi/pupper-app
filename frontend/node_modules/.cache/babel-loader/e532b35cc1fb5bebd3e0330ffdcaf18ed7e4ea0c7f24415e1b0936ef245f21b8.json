{"ast":null,"code":"import { parseMetadata } from './responseInfo.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n/**\n * Utility functions for serializing and deserializing of JSON protocol in general(including: REST-JSON, JSON-RPC, etc.)\n */\n/**\n * Error parser for AWS JSON protocol.\n */\nconst parseJsonError = async response => {\n  var _ref, _ref2, _response$headers$xA, _ref3, _body$message;\n  if (!response || response.statusCode < 300) {\n    return;\n  }\n  const body = await parseJsonBody(response);\n  const sanitizeErrorCode = rawValue => {\n    const [cleanValue] = rawValue.toString().split(/[,:]+/);\n    if (cleanValue.includes('#')) {\n      return cleanValue.split('#')[1];\n    }\n    return cleanValue;\n  };\n  const code = sanitizeErrorCode((_ref = (_ref2 = (_response$headers$xA = response.headers['x-amzn-errortype']) !== null && _response$headers$xA !== void 0 ? _response$headers$xA : body.code) !== null && _ref2 !== void 0 ? _ref2 : body.__type) !== null && _ref !== void 0 ? _ref : 'UnknownError');\n  const message = (_ref3 = (_body$message = body.message) !== null && _body$message !== void 0 ? _body$message : body.Message) !== null && _ref3 !== void 0 ? _ref3 : 'Unknown error';\n  const error = new Error(message);\n  return Object.assign(error, {\n    name: code,\n    $metadata: parseMetadata(response)\n  });\n};\n/**\n * Parse JSON response body to JavaScript object.\n */\nconst parseJsonBody = async response => {\n  if (!response.body) {\n    throw new Error('Missing response payload');\n  }\n  const output = await response.body.json();\n  return Object.assign(output, {\n    $metadata: parseMetadata(response)\n  });\n};\nexport { parseJsonBody, parseJsonError };\n//# sourceMappingURL=json.mjs.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}