{"ast":null,"code":"import _objectSpread from \"/home/nawaf/aws-project/pupper-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { AmplifyError } from '../../errors/AmplifyError.mjs';\nimport { AmplifyErrorCode } from '../../types/errors.mjs';\nimport '../../errors/errorHelpers.mjs';\nimport { withMemoization } from '../utils/memoization.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst shouldSendBody = method => !['HEAD', 'GET', 'DELETE'].includes(method.toUpperCase());\n// TODO[AllanZhengYP]: we need to provide isCanceledError utility\nconst fetchTransferHandler = async (_ref, _ref2) => {\n  var _resp$headers, _resp$body;\n  let {\n    url,\n    method,\n    headers,\n    body\n  } = _ref;\n  let {\n    abortSignal,\n    cache,\n    withCrossDomainCredentials\n  } = _ref2;\n  let resp;\n  try {\n    resp = await fetch(url, {\n      method,\n      headers,\n      body: shouldSendBody(method) ? body : undefined,\n      signal: abortSignal,\n      cache,\n      credentials: withCrossDomainCredentials ? 'include' : 'same-origin'\n    });\n  } catch (e) {\n    if (e instanceof TypeError) {\n      throw new AmplifyError({\n        name: AmplifyErrorCode.NetworkError,\n        message: 'A network error has occurred.',\n        underlyingError: e\n      });\n    }\n    throw e;\n  }\n  const responseHeaders = {};\n  (_resp$headers = resp.headers) === null || _resp$headers === void 0 || _resp$headers.forEach((value, key) => {\n    responseHeaders[key.toLowerCase()] = value;\n  });\n  const httpResponse = {\n    statusCode: resp.status,\n    headers: responseHeaders,\n    body: null\n  };\n  // resp.body is a ReadableStream according to Fetch API spec, but React Native\n  // does not implement it.\n  const bodyWithMixin = Object.assign((_resp$body = resp.body) !== null && _resp$body !== void 0 ? _resp$body : {}, {\n    text: withMemoization(() => resp.text()),\n    blob: withMemoization(() => resp.blob()),\n    json: withMemoization(() => resp.json())\n  });\n  return _objectSpread(_objectSpread({}, httpResponse), {}, {\n    body: bodyWithMixin\n  });\n};\nexport { fetchTransferHandler };\n//# sourceMappingURL=fetch.mjs.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}