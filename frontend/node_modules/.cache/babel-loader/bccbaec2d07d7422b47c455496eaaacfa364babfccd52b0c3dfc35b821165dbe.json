{"ast":null,"code":"import { DEFAULT_RETRY_ATTEMPTS, AMZ_SDK_REQUEST_HEADER } from './constants.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n/**\n * Middleware injects `amz-sdk-request` header to indicate the retry state at the time an HTTP request is made.\n * This middleware should co-exist with retryMiddleware as it relies on the retryAttempts value in middleware context\n * set by the retry middleware.\n *\n * Example header: `amz-sdk-request: attempt=1; max=3`.\n *\n * This middleware is standalone because of extra headers may conflict with custom endpoint settings(e.g. CORS), we will\n * NOT use this middleware for API categories.\n */\nconst amzSdkRequestHeaderMiddlewareFactory = _ref => {\n  let {\n    maxAttempts = DEFAULT_RETRY_ATTEMPTS\n  } = _ref;\n  return (next, context) => {\n    return async function amzSdkRequestHeaderMiddleware(request) {\n      var _context$attemptsCoun;\n      const attemptsCount = (_context$attemptsCoun = context.attemptsCount) !== null && _context$attemptsCoun !== void 0 ? _context$attemptsCoun : 0;\n      request.headers[AMZ_SDK_REQUEST_HEADER] = \"attempt=\".concat(attemptsCount + 1, \"; max=\").concat(maxAttempts);\n      return next(request);\n    };\n  };\n};\nexport { amzSdkRequestHeaderMiddlewareFactory };\n//# sourceMappingURL=amzSdkRequestHeaderMiddleware.mjs.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}