{"ast":null,"code":"import React,{useState,useRef}from'react';import{Upload,X,Image as ImageIcon,AlertCircle}from'lucide-react';import{imagesApi,apiUtils}from'../services/api';import{toast}from'react-toastify';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ImageUpload=_ref=>{let{onImageUploaded,dogId='',className=''}=_ref;const[isUploading,setIsUploading]=useState(false);const[preview,setPreview]=useState(null);const[uploadedImage,setUploadedImage]=useState(null);const fileInputRef=useRef(null);const handleFileSelect=event=>{const file=event.target.files[0];if(file){handleFile(file);}};const handleDrop=event=>{event.preventDefault();const file=event.dataTransfer.files[0];if(file){handleFile(file);}};const handleDragOver=event=>{event.preventDefault();};const handleFile=file=>{// Validate file type\nconst allowedTypes=['image/jpeg','image/jpg','image/png','image/webp'];if(!allowedTypes.includes(file.type)){toast.error('Please select a valid image file (JPEG, PNG, or WebP)');return;}// Validate file size (max 50MB)\nconst maxSize=50*1024*1024;// 50MB\nif(file.size>maxSize){toast.error('Image size must be less than 50MB');return;}// Create preview\nconst reader=new FileReader();reader.onload=e=>{setPreview(e.target.result);};reader.readAsDataURL(file);// Upload the file\nuploadFile(file);};const uploadFile=async file=>{setIsUploading(true);try{// Convert file to base64\nconst base64=await fileToBase64(file);// Prepare upload data\nconst uploadData={image_data:base64,content_type:file.type,dog_id:dogId,description:\"Uploaded image for \".concat(dogId?'dog':'new dog')};// Upload to API\nconst response=await imagesApi.uploadImage(uploadData);setUploadedImage(response.data);toast.success('Image uploaded successfully! ðŸ“¸');// Notify parent component\nif(onImageUploaded){onImageUploaded(response.data);}}catch(error){const errorInfo=apiUtils.handleError(error);toast.error(\"Failed to upload image: \".concat(errorInfo.message));setPreview(null);}finally{setIsUploading(false);}};const fileToBase64=file=>{return new Promise((resolve,reject)=>{const reader=new FileReader();reader.readAsDataURL(file);reader.onload=()=>resolve(reader.result);reader.onerror=error=>reject(error);});};const clearImage=()=>{setPreview(null);setUploadedImage(null);if(fileInputRef.current){fileInputRef.current.value='';}if(onImageUploaded){onImageUploaded(null);}};const openFileDialog=()=>{var _fileInputRef$current;(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4 \".concat(className),children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Dog Photo\"}),!preview&&!uploadedImage?/*#__PURE__*/// Upload area\n_jsxs(\"div\",{onClick:openFileDialog,onDrop:handleDrop,onDragOver:handleDragOver,className:\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-primary-400 hover:bg-primary-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",onChange:handleFileSelect,className:\"hidden\"}),isUploading?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner w-8 h-8 mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Uploading image...\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Upload,{className:\"w-12 h-12 text-gray-400 mx-auto\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 font-medium\",children:\"Click to upload or drag and drop\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:\"PNG, JPG, WebP up to 50MB\"})]})]})]}):/*#__PURE__*/// Preview area\n_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"border border-gray-300 rounded-lg p-4 bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:preview?/*#__PURE__*/_jsx(\"img\",{src:preview,alt:\"Preview\",className:\"w-24 h-24 object-cover rounded-lg border border-gray-200\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-24 h-24 bg-gray-200 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(ImageIcon,{className:\"w-8 h-8 text-gray-400\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 min-w-0\",children:uploadedImage?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm font-medium text-green-700 flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-2 h-2 bg-green-500 rounded-full mr-2\"}),\"Upload successful\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600\",children:[\"Size: \",(uploadedImage.size_bytes/1024).toFixed(1),\" KB\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600\",children:[\"Type: \",uploadedImage.content_type]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 truncate\",children:[\"ID: \",uploadedImage.image_id]})]}):isUploading?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm font-medium text-blue-700 flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner w-3 h-3 mr-2\"}),\"Uploading...\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600\",children:\"Please wait\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-700\",children:\"Ready to upload\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600\",children:\"Image selected\"})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:clearImage,disabled:isUploading,className:\"flex-shrink-0 p-1 text-gray-400 hover:text-red-500 transition-colors disabled:opacity-50\",title:\"Remove image\",children:/*#__PURE__*/_jsx(X,{size:16})})]})}),uploadedImage&&/*#__PURE__*/_jsx(\"button\",{onClick:openFileDialog,className:\"mt-2 text-sm text-primary-600 hover:text-primary-700 font-medium\",children:\"Upload different image\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-2 text-xs text-gray-500\",children:[/*#__PURE__*/_jsx(AlertCircle,{size:14,className:\"flex-shrink-0 mt-0.5\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Images are automatically resized and optimized. Supported formats: JPEG, PNG, WebP. Maximum file size: 50MB.\"})]}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",onChange:handleFileSelect,className:\"hidden\"})]});};export default ImageUpload;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}